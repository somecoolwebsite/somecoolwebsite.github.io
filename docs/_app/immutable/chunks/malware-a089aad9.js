import{S as de,i as ue,s as he,k as s,q as m,a as r,l as a,m as p,r as d,h as e,c as f,J as n,n as u,b as l,C as o,B as Kt}from"./index-fd23df92.js";function ne(me){let c,ct,V,w,wt,X,_,_t,Y,v,vt,Z,y,b,Ot,$,x,yt,g,E,bt,tt,I,k,Wt,et,P,xt,it,M,T,At,lt,G,Et,st,C,D,Ht,at,q,It,ot,K,O,Nt,pt,W,kt,rt,A,H,St,ft,h,Pt,L,Mt,Tt,Q,Gt,Ct,mt,N,S,Bt,dt,B,Dt,ut,J,qt,ht,j,R,Jt,nt,z,U,jt;return{c(){c=s("p"),ct=m("This is where I upload my findings in analysing malware from my honeypot"),V=r(),w=s("h2"),wt=m("> Mirai sample - 5/5/22"),X=r(),_=s("p"),_t=m("found a cool malware sample on my honeypot!"),Y=r(),v=s("p"),vt=m("I first strings\u2019ed it"),Z=r(),y=s("p"),b=s("img"),$=r(),x=s("p"),yt=m("and it gave me some interesting text (which lead me to believe it is a http c2 client)"),g=r(),E=s("p"),bt=m("There was also a lot of repeating weird text so i scanned it with yara"),tt=r(),I=s("p"),k=s("img"),et=r(),P=s("p"),xt=m("and found that it contained xored data. I then xor bruteforced it with cyberchef and found some text which resembled http headers with the key 0x4d"),it=r(),M=s("p"),T=s("img"),lt=r(),G=s("p"),Et=m("Obviously I copied the entire bit of seemingly xored in but it didn\u2019t look nice"),st=r(),C=s("p"),D=s("img"),at=r(),q=s("p"),It=m("so i found a tool called xcat on github and ran it on the binary with the key"),ot=r(),K=s("p"),O=s("img"),pt=r(),W=s("p"),kt=m("This produced more coherent text, but that still needed some cleaning so i piped that output into strings"),rt=r(),A=s("p"),H=s("img"),ft=r(),h=s("p"),Pt=m("The thing that stood out the most to me was the "),L=s("code"),Mt=m("/bin/busybox WICKED"),Tt=m(" and "),Q=s("code"),Gt=m("WICKED: applet not found"),Ct=m(" so I did a quick google and that yielded a bunch of results talking about the \u2018wicked family of bots\u2019"),mt=r(),N=s("p"),S=s("img"),dt=r(),B=s("p"),Dt=m("This showed me that I have a mirai botnet sample!"),ut=r(),J=s("p"),qt=m("I also uploaded it to virustotal and saw that it was first submitted 4 days ago AND came from the same IP address in my honeypot logs"),ht=r(),j=s("p"),R=s("img"),nt=r(),z=s("p"),U=s("img"),this.h()},l(t){c=a(t,"P",{});var i=p(c);ct=d(i,"This is where I upload my findings in analysing malware from my honeypot"),i.forEach(e),V=f(t),w=a(t,"H2",{});var zt=p(w);wt=d(zt,"> Mirai sample - 5/5/22"),zt.forEach(e),X=f(t),_=a(t,"P",{});var Ft=p(_);_t=d(Ft,"found a cool malware sample on my honeypot!"),Ft.forEach(e),Y=f(t),v=a(t,"P",{});var Lt=p(v);vt=d(Lt,"I first strings\u2019ed it"),Lt.forEach(e),Z=f(t),y=a(t,"P",{});var Qt=p(y);b=a(Qt,"IMG",{src:!0,alt:!0}),Qt.forEach(e),$=f(t),x=a(t,"P",{});var Rt=p(x);yt=d(Rt,"and it gave me some interesting text (which lead me to believe it is a http c2 client)"),Rt.forEach(e),g=f(t),E=a(t,"P",{});var Ut=p(E);bt=d(Ut,"There was also a lot of repeating weird text so i scanned it with yara"),Ut.forEach(e),tt=f(t),I=a(t,"P",{});var Vt=p(I);k=a(Vt,"IMG",{src:!0,alt:!0}),Vt.forEach(e),et=f(t),P=a(t,"P",{});var Xt=p(P);xt=d(Xt,"and found that it contained xored data. I then xor bruteforced it with cyberchef and found some text which resembled http headers with the key 0x4d"),Xt.forEach(e),it=f(t),M=a(t,"P",{});var Yt=p(M);T=a(Yt,"IMG",{src:!0,alt:!0}),Yt.forEach(e),lt=f(t),G=a(t,"P",{});var Zt=p(G);Et=d(Zt,"Obviously I copied the entire bit of seemingly xored in but it didn\u2019t look nice"),Zt.forEach(e),st=f(t),C=a(t,"P",{});var $t=p(C);D=a($t,"IMG",{src:!0,alt:!0}),$t.forEach(e),at=f(t),q=a(t,"P",{});var gt=p(q);It=d(gt,"so i found a tool called xcat on github and ran it on the binary with the key"),gt.forEach(e),ot=f(t),K=a(t,"P",{});var te=p(K);O=a(te,"IMG",{src:!0,alt:!0}),te.forEach(e),pt=f(t),W=a(t,"P",{});var ee=p(W);kt=d(ee,"This produced more coherent text, but that still needed some cleaning so i piped that output into strings"),ee.forEach(e),rt=f(t),A=a(t,"P",{});var ie=p(A);H=a(ie,"IMG",{src:!0,alt:!0}),ie.forEach(e),ft=f(t),h=a(t,"P",{});var F=p(h);Pt=d(F,"The thing that stood out the most to me was the "),L=a(F,"CODE",{});var le=p(L);Mt=d(le,"/bin/busybox WICKED"),le.forEach(e),Tt=d(F," and "),Q=a(F,"CODE",{});var se=p(Q);Gt=d(se,"WICKED: applet not found"),se.forEach(e),Ct=d(F," so I did a quick google and that yielded a bunch of results talking about the \u2018wicked family of bots\u2019"),F.forEach(e),mt=f(t),N=a(t,"P",{});var ae=p(N);S=a(ae,"IMG",{src:!0,alt:!0}),ae.forEach(e),dt=f(t),B=a(t,"P",{});var oe=p(B);Dt=d(oe,"This showed me that I have a mirai botnet sample!"),oe.forEach(e),ut=f(t),J=a(t,"P",{});var pe=p(J);qt=d(pe,"I also uploaded it to virustotal and saw that it was first submitted 4 days ago AND came from the same IP address in my honeypot logs"),pe.forEach(e),ht=f(t),j=a(t,"P",{});var re=p(j);R=a(re,"IMG",{src:!0}),re.forEach(e),nt=f(t),z=a(t,"P",{});var fe=p(z);U=a(fe,"IMG",{src:!0}),fe.forEach(e),this.h()},h(){n(b.src,Ot="https://media.discordapp.net/attachments/872259045820600325/971574427491893248/unknown.png?width=289&height=149")||u(b,"src",Ot),u(b,"alt","strings output"),n(k.src,Wt="https://media.discordapp.net/attachments/872259045820600325/971574427294765056/unknown.png?width=291&height=85")||u(k,"src",Wt),u(k,"alt","yara rule alerting to the prescense of xored data"),n(T.src,At="https://media.discordapp.net/attachments/872259045820600325/971574427710021673/unknown.png?width=822&height=465")||u(T,"src",At),u(T,"alt","cyberchef xor bruteforce"),n(D.src,Ht="https://media.discordapp.net/attachments/872259045820600325/971574427991019520/unknown.png?width=512&height=347")||u(D,"src",Ht),u(D,"alt","decoding the whole bit of the xored data"),n(O.src,Nt="https://media.discordapp.net/attachments/872259045820600325/971574428246880296/unknown.png?width=906&height=472")||u(O,"src",Nt),u(O,"alt","xor decoded data for the whole file using xcat"),n(H.src,St="https://media.discordapp.net/attachments/872259045820600325/971574428645347328/unknown.png?width=206&height=472")||u(H,"src",St),u(H,"alt","strings'ed xored data containing http headers and system calls"),n(S.src,Bt="https://media.discordapp.net/attachments/872259045820600325/971574428972490812/unknown.png?width=527&height=472")||u(S,"src",Bt),u(S,"alt","search results about 'wicked' malware"),n(R.src,Jt="https://cdn.discordapp.com/attachments/872259045820600325/971574429249331250/unknown.png")||u(R,"src",Jt),n(U.src,jt="https://media.discordapp.net/attachments/872259045820600325/971574429505163264/unknown.png?width=960&height=61")||u(U,"src",jt)},m(t,i){l(t,c,i),o(c,ct),l(t,V,i),l(t,w,i),o(w,wt),l(t,X,i),l(t,_,i),o(_,_t),l(t,Y,i),l(t,v,i),o(v,vt),l(t,Z,i),l(t,y,i),o(y,b),l(t,$,i),l(t,x,i),o(x,yt),l(t,g,i),l(t,E,i),o(E,bt),l(t,tt,i),l(t,I,i),o(I,k),l(t,et,i),l(t,P,i),o(P,xt),l(t,it,i),l(t,M,i),o(M,T),l(t,lt,i),l(t,G,i),o(G,Et),l(t,st,i),l(t,C,i),o(C,D),l(t,at,i),l(t,q,i),o(q,It),l(t,ot,i),l(t,K,i),o(K,O),l(t,pt,i),l(t,W,i),o(W,kt),l(t,rt,i),l(t,A,i),o(A,H),l(t,ft,i),l(t,h,i),o(h,Pt),o(h,L),o(L,Mt),o(h,Tt),o(h,Q),o(Q,Gt),o(h,Ct),l(t,mt,i),l(t,N,i),o(N,S),l(t,dt,i),l(t,B,i),o(B,Dt),l(t,ut,i),l(t,J,i),o(J,qt),l(t,ht,i),l(t,j,i),o(j,R),l(t,nt,i),l(t,z,i),o(z,U)},p:Kt,i:Kt,o:Kt,d(t){t&&e(c),t&&e(V),t&&e(w),t&&e(X),t&&e(_),t&&e(Y),t&&e(v),t&&e(Z),t&&e(y),t&&e($),t&&e(x),t&&e(g),t&&e(E),t&&e(tt),t&&e(I),t&&e(et),t&&e(P),t&&e(it),t&&e(M),t&&e(lt),t&&e(G),t&&e(st),t&&e(C),t&&e(at),t&&e(q),t&&e(ot),t&&e(K),t&&e(pt),t&&e(W),t&&e(rt),t&&e(A),t&&e(ft),t&&e(h),t&&e(mt),t&&e(N),t&&e(dt),t&&e(B),t&&e(ut),t&&e(J),t&&e(ht),t&&e(j),t&&e(nt),t&&e(z)}}}const we={title:"Malware analysis/Honepot stuff.",date:"2022-5-5"};class _e extends de{constructor(c){super(),ue(this,c,null,ne,he,{})}}export{_e as default,we as metadata};
