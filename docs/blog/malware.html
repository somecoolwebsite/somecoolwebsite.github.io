<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width" />
		
		<meta name="description" content="This website has no purpose other than a dumping ground for random blog posts.">
		<meta property="og:image" content="/profile.webp">
		
		<title>lockness-Ko</title>
		
		<meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_layout-6a01c3f4.css" rel="stylesheet">
		<link href="../_app/immutable/assets/_page-cc4ed907.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/start-8cbc8913.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-104dd4d8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons-9faa82f1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper-9b728935.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/_layout.svelte-85bcf2f0.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/_layout.ts-b8ee4d7c.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_layout-1daba58d.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/blog/_id_/_page.svelte-42a2a7e6.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/blog/_id_/_page.ts-4bbd162c.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_page-b7798fde.js">
	</head>
	<body>
		<div style="display: contents">


<header class="svelte-kqeq6i"><a href="/" class="svelte-kqeq6i">Home</a>

  <nav><ul class="svelte-kqeq6i"><li><a href="/blog" class="svelte-kqeq6i">Blog</a></li>
      <li><a href="/about" class="svelte-kqeq6i">About</a></li>
      <li><a href="/contact" class="svelte-kqeq6i">Contact</a></li></ul></nav>
</header>

<main><article><h1 class="svelte-7aimqn">Malware analysis/Honepot stuff.</h1>
  <p>Published: 2022-5-5</p>
  <hr>
  <div class="main-post"><p>This is where I upload my findings in analysing malware from my honeypot</p>
<h2>&gt; Mirai sample - 5/5/22</h2>
<p>found a cool malware sample on my honeypot! </p>
<p>I first strings’ed it</p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574427491893248/unknown.png?width=289&height=149" alt="strings output"></p>
<p>and it gave me some interesting text (which lead me to believe it is a http c2 client)</p>
<p>There was also a lot of repeating weird text so i scanned it with yara </p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574427294765056/unknown.png?width=291&height=85" alt="yara rule alerting to the prescense of xored data"></p>
<p>and found that it contained xored data. I then xor bruteforced it with cyberchef and found some text which resembled http headers with the key 0x4d </p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574427710021673/unknown.png?width=822&height=465" alt="cyberchef xor bruteforce"></p>
<p>Obviously I copied the entire bit of seemingly xored in but it didn’t look nice </p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574427991019520/unknown.png?width=512&height=347" alt="decoding the whole bit of the xored data"></p>
<p>so i found a tool called xcat on github and ran it on the binary with the key </p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574428246880296/unknown.png?width=906&height=472" alt="xor decoded data for the whole file using xcat"></p>
<p>This produced more coherent text, but that still needed some cleaning so i piped that output into strings </p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574428645347328/unknown.png?width=206&height=472" alt="strings'ed xored data containing http headers and system calls"></p>
<p>The thing that stood out the most to me was the <code>/bin/busybox WICKED</code> and <code>WICKED: applet not found</code> so I did a quick google and that yielded a bunch of results talking about the ‘wicked family of bots’</p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574428972490812/unknown.png?width=527&height=472" alt="search results about 'wicked' malware"></p>
<p>This showed me that I have a mirai botnet sample!</p>
<p>I also uploaded it to virustotal and saw that it was first submitted 4 days ago AND came from the same IP address in my honeypot logs</p>
<p><img src="https://cdn.discordapp.com/attachments/872259045820600325/971574429249331250/unknown.png"></p>
<p><img src="https://media.discordapp.net/attachments/872259045820600325/971574429505163264/unknown.png?width=960&height=61"></p></div>
</article>

  <!-- HTML_TAG_START --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "6e484827d6d940bc9806ee8ffc5be0b9"}'></script><!-- HTML_TAG_END -->
</main>


		<script type="module" data-sveltekit-hydrate="14vnhgt">
			import { start } from "../_app/immutable/start-8cbc8913.js";

			start({
				env: {},
				hydrate: {
					status: 200,
					error: null,
					node_ids: [0, 5],
					params: {id:"malware"},
					route: {"id":"/blog/[id]"},
					data: [null,null],
					form: null
				},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="14vnhgt"]').parentNode,
				version: "1730603171365"
			});
		</script>
	</div>
	</body>
</html>
